"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[5222],{5698:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>a,default:()=>l,frontMatter:()=>s,metadata:()=>d,toc:()=>c});var i=n(4848),o=n(8453);const s={sidebar_position:20},a="Placing Bids",d={id:"auction-smart-contract/end-to-end/placing-bids",title:"Placing Bids",description:"Now we can start bidding.",source:"@site/docs/auction-smart-contract/end-to-end/placing-bids.md",sourceDirName:"auction-smart-contract/end-to-end",slug:"/auction-smart-contract/end-to-end/placing-bids",permalink:"/docs/auction-smart-contract/end-to-end/placing-bids",draft:!1,unlisted:!1,editUrl:"https://github.com/IntersectMBO/plutus/edit/master/doc/docusaurus/docs/auction-smart-contract/end-to-end/placing-bids.md",tags:[],version:"current",sidebarPosition:20,frontMatter:{sidebar_position:20},sidebar:"tutorialSidebar",previous:{title:"Minting the Token to be Auctioned",permalink:"/docs/auction-smart-contract/end-to-end/mint"},next:{title:"Closing the Auction",permalink:"/docs/auction-smart-contract/end-to-end/closing-the-auction"}},r={},c=[];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",sup:"sup",ul:"ul",...(0,o.R)(),...e.components},{LiteralInclude:n}=t;return n||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("LiteralInclude",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"placing-bids",children:"Placing Bids"}),"\n",(0,i.jsx)(t.p,{children:"Now we can start bidding.\nLet's place a bid of 100 Ada from bidder1, followed by a bid of 200 Ada from bidder2.\nEach transaction that places a bid must do the following:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Spend the UTxO that contains the token being auctioned.\nFor bidder1, the transaction that produced the UTxO is the one that minted the token.\nFor bidder2, the transaction that produced the UTxO is bidder1's transaction.\nThe address of this UTxO is always the auction validator's script address, so each bidding transaction must include the auction validator and a redeemer",(0,i.jsx)(t.sup,{children:(0,i.jsx)(t.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["Place a bid (via the redeemer) with an amount at least as high as the auction's minimum bid, and higher than the previous highest bid (if any).\nThe existence and the details of a previous highest bid can be determined by inspecting the datum attached to the aforementioned UTxO.\nThis is enforced by the auction validator's ",(0,i.jsx)(t.code,{children:"sufficientBid"})," condition."]}),"\n",(0,i.jsxs)(t.li,{children:["Lock the token being auctioned, together with the bid amount, in a new UTxO at the auction validator's script address.\nThe new UTxO should also include a datum containing the details of this bid.\nThis is enforced by the auction validator's ",(0,i.jsx)(t.code,{children:"correctOutput"})," condition."]}),"\n",(0,i.jsxs)(t.li,{children:["Refund the previous highest bid (if any) to its bidder's wallet address.\nThis is enforced by the auction validator's ",(0,i.jsx)(t.code,{children:"refundsPreviousHighestBid"})," condition."]}),"\n",(0,i.jsxs)(t.li,{children:["Set a validity interval that ends no later than the auction's end time.\nThis is enforced by the auction validator's ",(0,i.jsx)(t.code,{children:"validBidTime"})," condition."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["To submit these bidding transactions, create a file named ",(0,i.jsx)(t.code,{children:"off-chain/bid.mjs"})," for the off-chain code, with the following content:"]}),"\n",(0,i.jsx)(n,{file:"bid.mjs",language:"javascript",title:"bid.mjs"}),"\n",(0,i.jsx)(t.p,{children:"This Javascript module builds and submits a transaction that does exactly the above."}),"\n",(0,i.jsx)(t.p,{children:"The following substitutions are needed:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Substitute your Blockfrost project ID for ",(0,i.jsx)(t.code,{children:"Replace with Blockfrost Project ID"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["Substitute a slot number no later than the auction's end time for ",(0,i.jsx)(t.code,{children:"Replace with transaction expiration time"}),".\nFor instance, if you set the auction's end time to be approximately 24 hours from now, you can use a slot number corresponding to approximately 12 hours from now.\nTo determine the slot number, go to ",(0,i.jsx)(t.a,{href:"https://preview.cardanoscan.io/",children:"Cardanoscan"}),", click on a recent transaction, take its Absolute Slot, and add 12 hours (43200) to it."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Place the first bid by running"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"node bid.mjs <minting-transaction-hash> bidder1 100000000\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Replace ",(0,i.jsx)(t.code,{children:"<minting-transaction-hash>"})," with the hash of the transaction we previously submitted for minting the token.\nThis hash is used by the off-chain code to locate the UTxO that contains the token."]}),"\n",(0,i.jsx)(t.p,{children:"After the first bidding transaction is confirmed, we can submit the second bid from bidder2, with a similar command:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"node bid.mjs <bidder1-transaction-hash> bidder2 200000000\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Replace ",(0,i.jsx)(t.code,{children:"<bidder1-transaction-hash>"})," with the hash of the previous transaction."]}),"\n",(0,i.jsx)(t.hr,{}),"\n","\n",(0,i.jsxs)(t.section,{"data-footnotes":!0,className:"footnotes",children:[(0,i.jsx)(t.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{id:"user-content-fn-1",children:["\n",(0,i.jsxs)(t.p,{children:["Instead of including the script in the transaction, we can use a reference script, but to keep things simple, we won't discuss that here. ",(0,i.jsx)(t.a,{href:"#user-content-fnref-1","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function l(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>d});var i=n(6540);const o={},s=i.createContext(o);function a(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);