<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-auction-smart-contract/life-cycle" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.0">
<title data-rh="true">Life cycle of the auction smart contract | Plutus Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://plutus.cardano.intersectmbo.org/docs/img/docusaurus-social-card.png"><meta data-rh="true" name="twitter:image" content="https://plutus.cardano.intersectmbo.org/docs/img/docusaurus-social-card.png"><meta data-rh="true" property="og:url" content="https://plutus.cardano.intersectmbo.org/docs/auction-smart-contract/life-cycle"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Life cycle of the auction smart contract | Plutus Documentation"><meta data-rh="true" name="description" content="With the Plutus script written, Alice is now ready to start the auction smart contract."><meta data-rh="true" property="og:description" content="With the Plutus script written, Alice is now ready to start the auction smart contract."><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://plutus.cardano.intersectmbo.org/docs/auction-smart-contract/life-cycle"><link data-rh="true" rel="alternate" href="https://plutus.cardano.intersectmbo.org/docs/auction-smart-contract/life-cycle" hreflang="en"><link data-rh="true" rel="alternate" href="https://plutus.cardano.intersectmbo.org/docs/auction-smart-contract/life-cycle" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X6364ZT8L2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-X6364ZT8L2",{anonymize_ip:!0})</script><link rel="stylesheet" href="/docs/assets/css/styles.6c74e203.css">
<script src="/docs/assets/js/runtime~main.775a6ab9.js" defer="defer"></script>
<script src="/docs/assets/js/main.8e0e8021.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.svg" alt="Plutus Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/logo.svg" alt="Plutus Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Plutus</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">User guide</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item"><a href="https://github.com/IntersectMBO/plutus" class="github-link" target="_blank"></a></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Plutus user guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/example-an-auction-smart-contract">Example: An Auction Smart Contract</a><button aria-label="Collapse sidebar category &#x27;Example: An Auction Smart Contract&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/auction-smart-contract/on-chain-code">On-chain Code: The Auction Validator</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/end-to-end">End to end</a><button aria-label="Expand sidebar category &#x27;End to end&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/auction-smart-contract/life-cycle">Life cycle of the auction smart contract</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/essential-concepts">Essential concepts</a><button aria-label="Expand sidebar category &#x27;Essential concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/using-plutus-tx">Using Plutus Tx</a><button aria-label="Expand sidebar category &#x27;Using Plutus Tx&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/working-with-scripts">Working with scripts</a><button aria-label="Expand sidebar category &#x27;Working with scripts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/delve-deeper">Delve Deeper</a><button aria-label="Expand sidebar category &#x27;Delve Deeper&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/troubleshooting">Troubleshooting</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/example-an-auction-smart-contract"><span itemprop="name">Example: An Auction Smart Contract</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Life cycle of the auction smart contract</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Life cycle of the auction smart contract</h1>
<p>With the Plutus script written, Alice is now ready to start the auction smart contract.
At the outset, Alice creates a script UTXO whose address is the hash of the Plutus script, whose value is the token to be auctioned, and whose datum is <code>Nothing</code>.
Recall that the datum represents the highest bid, and there&#x27;s no bid yet.
This script UTXO also contains the script itself, so that nodes validating transactions that try to spend this script UTXO have access to the script.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="initial-utxo">Initial UTXO<a href="#initial-utxo" class="hash-link" aria-label="Direct link to Initial UTXO" title="Direct link to Initial UTXO">​</a></h2>
<p>Alice needs to create the initial UTXO transaction with the desired UTXO as an output.
The token being auctioned can either be minted by this transaction, or if it already exists in another UTXO on the ledger, the transaction should consume that UTXO as an input.
We will not go into the details here of how minting tokens works.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-first-bid">The first bid<a href="#the-first-bid" class="hash-link" aria-label="Direct link to The first bid" title="Direct link to The first bid">​</a></h2>
<p>Suppose Bob, the first bidder, wants to bid 100 Ada for Alice&#x27;s NFT.
In order to do this, Bob creates a transaction that has at least two inputs and at least one output.</p>
<p>The required inputs are (1) the script UTXO Alice created; (2) Bob&#x27;s bid of 100 Ada.
The 100 Ada can come in one or multiple UTXOs.
Note that the input UTXOs must have a total value of more than 100 Ada, because in addition to the bid amount, they also need to cover the transaction fee.</p>
<p>The required output is a script UTXO with the same address as the initial UTXO (since the Plutus script itself remains the same), which is known as a <em>continuing output</em>.
This continuing output UTXO should contain:</p>
<ul>
<li>a datum that contains Bob&#x27;s wallet address and Bob&#x27;s bid amount (100 Ada).<!-- -->
<ul>
<li>Bob&#x27;s wallet address is used to claim the token (if Bob ends up winning the auction) or receive the refund (if a higher bid is placed later).</li>
</ul>
</li>
<li>a value: the token being auctioned plus the 100 Ada from Bob&#x27;s bid.</li>
</ul>
<p>If the input UTXOs contain more Ada than 100 plus the transaction fee, then there should be additional output UTXOs that return the extra Ada.
Again, verifying that the input value of a transaction minus the transaction fee equals the output value (unless the transaction is burning tokens) is the responsibility of the ledger, not the Plutus script.</p>
<p>In order for Bob&#x27;s transaction to be able to spend the initial script UTXO Alice created, Bob&#x27;s transaction must also contain a redeemer.
As shown in the code above, there are two kinds of redeemers in our example: <code>NewBid Bid</code> and <code>Payout</code>.
The redeemer in Bob&#x27;s transaction is a <code>NewBid Bid</code> where the <code>Bid</code> contains Bob&#x27;s wallet address and bid amount.</p>
<p><img decoding="async" loading="lazy" alt="First bid diagram" src="/docs/assets/images/first-bid-simple-auction-v3-947f705bccd8e1f4d6fe1699105a4a4d.png" width="3241" height="1801" class="img_ev3q"></p>
<p>Once Bob&#x27;s transaction is submitted, the node validating this transaction will run the Plutus script, which checks a number of conditions like whether the bid happens before the deadline, and whether the bid is high enough.
If the checks pass and everything else about the transaction is valid, the transaction will go through and be included in a block.
At this point, the initial UTXO created by Alice no longer exists on the ledger, since it has been spent by Bob&#x27;s transaction.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-second-bid">The second bid<a href="#the-second-bid" class="hash-link" aria-label="Direct link to The second bid" title="Direct link to The second bid">​</a></h2>
<p>Next, suppose a second bidder, Charlie, wants to outbid Bob.
Charlie wants to bid 200 Ada.</p>
<p>Charlie will create another transaction.
This transaction should have an additional output compared to Bob&#x27;s transaction: a UTXO that returns Bob&#x27;s bid of 100 Ada.
Recall that this is one of the conditions checked by the Plutus script; the transaction is rejected if the refund output is missing.</p>
<p><img decoding="async" loading="lazy" alt="Second bid diagram" src="/docs/assets/images/second-bid-simple-auction-v3-c35d927ac377099f22d0705b4ed183bf.png" width="3241" height="1801" class="img_ev3q"></p>
<p>Charlie&#x27;s transaction needs to spend the script UTXO produced by Bob&#x27;s transaction, so it also needs a redeemer.
The redeemer is a <code>NewBid Bid</code> where <code>Bid</code> contains Charlie&#x27;s wallet address and bid amount.
Charlie&#x27;s transaction cannot spend the initial UTXO produced by Alice, since it has already been spent by Bob&#x27;s transaction.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="closing-the-auction">Closing the auction<a href="#closing-the-auction" class="hash-link" aria-label="Direct link to Closing the auction" title="Direct link to Closing the auction">​</a></h2>
<p>Let&#x27;s assume that there won&#x27;t be another bid.
Once the deadline has passed, the auction can be closed.</p>
<p>In order to do that, somebody has to create another transaction.
That could be Alice, who wants to collect the bid, or it could be Charlie, who wants to collect the NFT.
It can be anybody, but Alice and Charlie have an incentive to create it.</p>
<p>This transaction has one required input: the script UTXO produced by Charlie&#x27;s transaction, and two required outputs: (1) the payment of the auctioned token to Charlie; (2) the payment of 200 Ada to Alice.</p>
<p><img decoding="async" loading="lazy" alt="Closing transaction diagram" src="/docs/assets/images/closing-tx-simple-auction-v3-5213bec3a2100cd0906d59dc29978ad8.png" width="3241" height="1801" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/IntersectMBO/plutus/edit/master/doc/docusaurus/docs/auction-smart-contract/life-cycle.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/auction-smart-contract/end-to-end/closing-the-auction"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Closing the Auction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/essential-concepts"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Essential concepts</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#initial-utxo" class="table-of-contents__link toc-highlight">Initial UTXO</a></li><li><a href="#the-first-bid" class="table-of-contents__link toc-highlight">The first bid</a></li><li><a href="#the-second-bid" class="table-of-contents__link toc-highlight">The second bid</a></li><li><a href="#closing-the-auction" class="table-of-contents__link toc-highlight">Closing the auction</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="footer-container"><div class="footer-left"><img class="footer-logo" src="/docs/img/logo-footer.svg" alt="Plutus"><span>Copyright ©<!-- -->2024<!-- --> IOHK. Built with Docusaurus.</span></div><div class="footer-right"><a href="/docs/">User Guide</a><a href="https://github.com/IntersectMBO/plutus" class="github-link" target="_blank"></a></div></div></footer></div>
</body>
</html>